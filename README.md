<p>Works similarly to slamsim for two populations but can take up to 8 source populations. Also added possibility to simulate sexual chromosomes.</p>

Required softwares and packages:
-----------------------
<p><strong><a href="https://messerlab.org/slim/">SLiM</a> </strong></p>
<p><strong>Python:</strong>
<li>numpy</li></p>
<p><strong>R:</strong>
<li>e1071</li>
<li>optparse</li></p>
<p><strong>Other:</strong>
<li><a href="https://github.com/szpiech/asd/blob/master/README">asd software</a></li>
<li><a href="https://www.gnu.org/software/parallel/">GNU parallel</a></li>
<li><a href="https://vcftools.sourceforge.net/">vcftools</a></li></p>

To launch script, run :
-----------------------
<code>./SLAMSim.py --slim_sim slim_sim.slim --directory [parfiles] --vcf [vcf_pop_source] --sample [N] --bp [L] --fAM [min1-max1] --sigma [min2-max2] --compute_sumstats compute_sumstats.py --transform_vcf vcf_change.py --R [recombination rates] (--activate_X) (--activate_Y) --bpX [Lx] --bpY [Ly] --vcfX [vcf_pop_sources_X] --vcfY [vcf_pop_source_Y] --j [J] --asd_path [asd_path]</code> in the slamsim folder.

Arguments:
-----------------------
<li>[parfiles] is the path to the folders containing the parameter files (same format as .extpar files generated by generate_param_5p.py and extend_param.py). There is one file per simulation. For each file, each lines contains the generation (g), the size of source populations and the admixed populations, and the contribution from all source populations at this generation. </li>
<li>[vcf_pop_source] is the path to the vcf containing samples from source populations. Populations are indicated in the ids of individual (ex: p1_ind1, p2_ind33). Populations are ordered (p1 then p2 then p3 etc.) and females individuals are before males in each population.</li>
<li>[vcf_pop_source_X] is the path to the vcf containing samples from source populations. Populations are indicated in the ids of individual (ex: p1_ind1, p2_ind33). Optional argument: only if --activate_X. Populations are ordered (p1 then p2 then p3 etc.) and females individuals are before males in each population.</li>
<li>[vcf_pop_source_Y] is the path to the vcf containing samples from source populations. Populations are indicated in the ids of individual (ex: p1_ind1, p2_ind33). Optional argument: only if --activate_Y. Populations are ordered (p1 then p2 then p3 etc.) and females individuals are before males in each population.</li>
<li>[L] is the length of the autosomal genome (in bp)</li>
<li>[Lx] is the length of the X chromosome (in bp). Optional argument: only if --activate_X.</li>
<li>[Ly] is the length of the Y chromosome (in bp). Optional argument: only if --activate_X=Y.</li>
<li>[N] is the number of individuals to sample to compute the summary statistics</li>
<li>[L] is the size of the genome that is simulated (needed by SLiM)</li>
<li>[min1-max1] is the range of variation of fAM to use for simulations (randomly picked from a uniform distribution for each simulation)</li>
<li>[min2-max2] is the range of variation of sigma to use for simulations (randomly picked from a uniform distribution for each simulation)</li>
<li>[recombination rates] is a recombination rate maps (two columns, one containing breakpoints and the other containing recombination rate between this breakpoint and the previous one)</li>
<li>[J] the number of simulations to launch in parallel</li>
<li>[asd_path] path to <a href="https://github.com/szpiech/asd/blob/master/README">asd software</a> (on user's computer)</li>

Output
---------------------
The output will be summary statistic files .sumstat. For each simulations, they will be found in the same folders as the parameters files. For each simulations, the social_ID file recalls the tag used by slim simulations for all individuals at each generation in the admixed population. There will also be a fAM_file, recalling the value of fAM for each simulation and a sigma_file recalling the value of sigma for each simulation. 
(As of now, summary statistics are computed on autosomes only...)

Example with 5 populations:
---------------------
<p><strong>Generate parameters files with generate_params.py:</strong></p>
<p><code>./generate_params.py -S 10 -N 10 -P test --Ne 100/Con/100-100 --contrib_s1 default/Pulse/2/0.4-0.4/0-0.2 --contrib_s2 default/Pulse/2/0.6-0.6/0-0.2</code></p>
<p>This should create a folder containing 10 folders (one for each simulation) containing .par files that are the parameters files. </p>
<p><strong>Example with toy source vcf and default recombination rate (10⁻⁸):</strong></p>
<p>You may need to modify authorizations for the scripts by running: <code>chmod +x *</code> in the slamsim folder.</p>
<p>Then run the following in the slamsim folder:</p>
<p><code>./SLAMSim.py --slim_sim slim_sim.slim --directory test/ --vcf VCF_toy.vcf --sample 50 --bp 1000000000 --fAM 0-2 --sigma 0-0.2 --compute_sumstats compute_sumstats.py --transform_vcf vcf_change.py --R default_rec_map --j 10 --asd_path [asd_path]</code></p>
<p><em>Don't forget to add path to asd software. It should end with /asd/src/asd.</em></p>
